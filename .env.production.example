# =============================================================================
# Upstream Production Environment Configuration
# =============================================================================
# Copy this file to .env.production and update all values for your production environment.
# NEVER commit .env.production to version control!
#
# Security Checklist:
# [ ] All values below are filled in
# [ ] All secrets are strong and unique
# [ ] All URLs use HTTPS
# [ ] File permissions set to 600 (owner read/write only)

# -----------------------------------------------------------------------------
# Django Core Settings (REQUIRED)
# -----------------------------------------------------------------------------

# Generate with: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
# MUST be at least 50 characters, unique per environment
SECRET_KEY=

# MUST be False in production
DEBUG=False

# Comma-separated list of allowed hostnames (NO wildcards!)
# Example: yourdomain.com,www.yourdomain.com,api.yourdomain.com
ALLOWED_HOSTS=

# -----------------------------------------------------------------------------
# Security Settings (REQUIRED FOR PRODUCTION)
# -----------------------------------------------------------------------------

# HTTPS/SSL (MUST be True for production)
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True

# HSTS Settings (HTTP Strict Transport Security)
# Start with 3600 (1 hour), increase to 31536000 (1 year) after testing
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# CSRF Trusted Origins (required if behind reverse proxy)
# Comma-separated list with scheme: https://yourdomain.com,https://api.yourdomain.com
CSRF_TRUSTED_ORIGINS=

# -----------------------------------------------------------------------------
# Database Configuration (REQUIRED)
# -----------------------------------------------------------------------------

# Option 1: DATABASE_URL (Recommended - 12-factor app style)
# Format: postgres://username:password@hostname:port/database?sslmode=require
# Example: postgres://upstream_user:securepassword@db.example.com:5432/upstream?sslmode=require
DATABASE_URL=

# Option 2: Individual database settings (Alternative to DATABASE_URL)
# DB_NAME=upstream
# DB_USER=upstream_user
# DB_PASSWORD=
# DB_HOST=db.example.com
# DB_PORT=5432
# DB_SSLMODE=require

# -----------------------------------------------------------------------------
# Redis Configuration (REQUIRED FOR PRODUCTION)
# -----------------------------------------------------------------------------

# Redis URL for caching and Celery
# Format: redis://[:password]@hostname:port
# Example: redis://:securepassword@redis.example.com:6379
REDIS_URL=

# -----------------------------------------------------------------------------
# Email Configuration (REQUIRED)
# -----------------------------------------------------------------------------

# Production email backend (MUST use real email service)
# Options: anymail.backends.mailgun.EmailBackend, anymail.backends.sendgrid.EmailBackend
EMAIL_BACKEND=anymail.backends.mailgun.EmailBackend

# Mailgun Settings (if using Mailgun)
MAILGUN_API_KEY=
MAILGUN_DOMAIN=

# SendGrid Settings (if using SendGrid)
# SENDGRID_API_KEY=

# Sender email address (REQUIRED)
DEFAULT_FROM_EMAIL=alerts@yourdomain.com

# -----------------------------------------------------------------------------
# Portal Configuration (REQUIRED)
# -----------------------------------------------------------------------------

# Base URL for email links (MUST be HTTPS in production)
# Example: https://app.yourdomain.com
PORTAL_BASE_URL=

# -----------------------------------------------------------------------------
# CORS Configuration (REQUIRED IF USING FRONTEND)
# -----------------------------------------------------------------------------

# Comma-separated list of allowed origins (with scheme)
# Example: https://yourdomain.com,https://app.yourdomain.com
CORS_ALLOWED_ORIGINS=

# -----------------------------------------------------------------------------
# PHI Data Protection (REQUIRED FOR REAL PATIENT DATA)
# -----------------------------------------------------------------------------

# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# REQUIRED when REAL_DATA_MODE=True
FIELD_ENCRYPTION_KEY=

# Set to True when handling real patient data (PHI)
# When True, FIELD_ENCRYPTION_KEY is REQUIRED
REAL_DATA_MODE=False

# -----------------------------------------------------------------------------
# Celery Configuration (REQUIRED FOR BACKGROUND TASKS)
# -----------------------------------------------------------------------------

# Enable Celery for production
CELERY_ENABLED=True

# Celery broker and result backend (usually same as REDIS_URL)
CELERY_BROKER_URL=
CELERY_RESULT_BACKEND=

# -----------------------------------------------------------------------------
# Flower Dashboard (Celery Monitoring)
# -----------------------------------------------------------------------------

# Flower authentication credentials (change in production!)
FLOWER_BASIC_AUTH_USERNAME=admin
FLOWER_BASIC_AUTH_PASSWORD=<change-in-production>
FLOWER_PORT=5555

# -----------------------------------------------------------------------------
# Feature Flags (OPTIONAL)
# -----------------------------------------------------------------------------

# Enable Slack integration for alerts
SLACK_ENABLED=False
# SLACK_WEBHOOK_URL=

# Enable PDF attachments in alert emails
ALERT_ATTACH_PDF=False

# -----------------------------------------------------------------------------
# Error Tracking (STRONGLY RECOMMENDED)
# -----------------------------------------------------------------------------

# Sentry DSN for error tracking
# Get from: https://sentry.io/settings/[org]/projects/[project]/keys/
SENTRY_DSN=

# Sentry release version (for tracking deployments)
SENTRY_RELEASE=

# Environment name (for Sentry)
ENVIRONMENT=production

# Server name (for multi-server deployments)
# SERVER_NAME=

# -----------------------------------------------------------------------------
# Application Performance Monitoring (DataDog APM)
# -----------------------------------------------------------------------------

# DataDog API Key for APM traces
# Get from: https://app.datadoghq.com/organization-settings/api-keys
DD_API_KEY=

# DataDog site (region)
# US: datadoghq.com (default)
# EU: datadoghq.eu
DD_SITE=datadoghq.com

# Service name for APM (identifies your application in DataDog)
# Example: upstream-api, upstream-celery
DD_SERVICE=upstream-api

# Environment (should match SENTRY_ENVIRONMENT for correlation)
# Example: production, staging, development
DD_ENV=production

# Version/release identifier (correlate with Sentry releases)
# Recommended: Git commit SHA or semantic version
# Example: 1.2.3 or abc123def
DD_VERSION=

# Note: DataDog Agent must be running to receive traces
# Agent installation: https://docs.datadoghq.com/agent/
# Agent listens on localhost:8126 by default

# -----------------------------------------------------------------------------
# -----------------------------------------------------------------------------
# Platform Health Alerts (RECOMMENDED)
# -----------------------------------------------------------------------------

# Enable/disable monitoring alerts for platform health
# These are OPERATOR alerts (system health), distinct from business alerts
MONITORING_ALERTS_ENABLED=true

# Email notifications for critical platform alerts
ALERT_EMAIL_ENABLED=true
ALERT_EMAIL_RECIPIENTS=ops@your-company.com,oncall@your-company.com
ALERT_FROM_EMAIL=alerts@your-company.com

# Slack notifications (optional but recommended)
# Create webhook: https://api.slack.com/messaging/webhooks
# 1. Go to https://api.slack.com/apps
# 2. Create new app or select existing
# 3. Enable Incoming Webhooks
# 4. Add New Webhook to Workspace
# 5. Copy webhook URL
ALERT_SLACK_ENABLED=true
ALERT_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
ALERT_SLACK_CHANNEL=#alerts

# Alert thresholds (optional overrides - defaults shown)
# Uncomment to customize thresholds for your environment
# ALERT_THRESHOLD_ERROR_RATE=0.05        # 5% error rate triggers alert
# ALERT_THRESHOLD_RESPONSE_TIME=2000     # 2 seconds p95 triggers alert
# ALERT_THRESHOLD_DB_POOL=0.90           # 90% pool utilization triggers alert
# ALERT_THRESHOLD_CELERY_FAILURES=0.10   # 10% task failures triggers alert

# Alertmanager integration (optional - for advanced routing)
# If using Prometheus Alertmanager for centralized alert routing
# ALERTMANAGER_URL=http://alertmanager:9093

# Monitoring & Observability (OPTIONAL)
# -----------------------------------------------------------------------------

# Google Cloud Project ID (if using GCP)
# GCP_PROJECT_ID=

# AWS Region (if using AWS)
# AWS_REGION=us-east-1

# -----------------------------------------------------------------------------
# Deployment Metadata (OPTIONAL BUT RECOMMENDED)
# -----------------------------------------------------------------------------

# Git commit SHA for this deployment
# DEPLOY_COMMIT_SHA=

# Deployment timestamp
# DEPLOY_TIMESTAMP=

# Deployed by (username or service account)
# DEPLOYED_BY=

# =============================================================================
# SECURITY CHECKLIST BEFORE DEPLOYING
# =============================================================================
#
# Run this command to validate your production settings:
#   python scripts/validate_production_settings.py
#
# Required checks:
# [ ] DEBUG=False
# [ ] SECRET_KEY is strong (50+ characters)
# [ ] ALLOWED_HOSTS set (no wildcards)
# [ ] HTTPS settings enabled (SECURE_SSL_REDIRECT=True)
# [ ] DATABASE_URL uses PostgreSQL with SSL
# [ ] REDIS_URL configured
# [ ] EMAIL_BACKEND uses real email service
# [ ] PORTAL_BASE_URL uses HTTPS
# [ ] FIELD_ENCRYPTION_KEY set (if REAL_DATA_MODE=True)
# [ ] SENTRY_DSN configured for error tracking
# [ ] File permissions: chmod 600 .env.production
#
# Optional but recommended:
# [ ] CSRF_TRUSTED_ORIGINS set (if using reverse proxy)
# [ ] CELERY_ENABLED=True
# [ ] SLACK_ENABLED=True (for team notifications)
#
# =============================================================================
