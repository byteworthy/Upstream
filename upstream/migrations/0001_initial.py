# Generated by Django 5.2.10 on 2026-01-24 08:54

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="Customer",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("name", models.CharField(max_length=255, unique=True)),
            ],
        ),
        migrations.CreateModel(
            name="SystemConfiguration",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("key", models.CharField(max_length=100, unique=True)),
                ("value", models.TextField()),
                ("description", models.TextField(blank=True, null=True)),
            ],
            options={
                "verbose_name": "System Configuration",
                "verbose_name_plural": "System Configurations",
            },
        ),
        migrations.CreateModel(
            name="AlertRule",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100)),
                ("description", models.TextField(blank=True)),
                (
                    "scope",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="JSON scope filter (payer, cpt_group, etc.)",
                    ),
                ),
                (
                    "metric",
                    models.CharField(
                        choices=[
                            ("severity", "Drift Severity"),
                            ("denial_rate_delta", "Denial Rate Delta"),
                            ("decision_time_delta", "Decision Time Delta"),
                        ],
                        default="severity",
                        max_length=50,
                    ),
                ),
                (
                    "threshold_type",
                    models.CharField(
                        choices=[
                            ("gt", "Greater Than"),
                            ("gte", "Greater Than or Equal"),
                            ("lt", "Less Than"),
                            ("lte", "Less Than or Equal"),
                            ("eq", "Equal"),
                        ],
                        default="gte",
                        max_length=20,
                    ),
                ),
                (
                    "threshold_value",
                    models.FloatField(
                        default=0.7, help_text="Threshold value for triggering alert"
                    ),
                ),
                ("enabled", models.BooleanField(default=True)),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("info", "Informational"),
                            ("warning", "Warning"),
                            ("critical", "Critical"),
                            ("emergency", "Emergency"),
                        ],
                        default="warning",
                        max_length=20,
                    ),
                ),
                (
                    "routing_priority",
                    models.IntegerField(
                        default=0,
                        help_text="Priority for rule evaluation order (higher = earlier)",
                    ),
                ),
                (
                    "routing_tags",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="Tags for categorizing and routing alerts",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="alert_rules",
                        to="upstream.customer",
                    ),
                ),
            ],
            options={
                "verbose_name": "Alert Rule",
                "verbose_name_plural": "Alert Rules",
            },
        ),
        migrations.CreateModel(
            name="Alert",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("title", models.CharField(max_length=200)),
                ("message", models.TextField()),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("info", "Informational"),
                            ("warning", "Warning"),
                            ("critical", "Critical"),
                            ("emergency", "Emergency"),
                        ],
                        max_length=20,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("new", "New"),
                            ("acknowledged", "Acknowledged"),
                            ("resolved", "Resolved"),
                            ("escalated", "Escalated"),
                        ],
                        default="new",
                        max_length=20,
                    ),
                ),
                (
                    "related_entity_type",
                    models.CharField(blank=True, max_length=50, null=True),
                ),
                (
                    "related_entity_id",
                    models.CharField(blank=True, max_length=100, null=True),
                ),
                ("resolution_notes", models.TextField(blank=True, null=True)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "resolved_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="resolved_alerts",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "rule",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.PROTECT,
                        to="upstream.alertrule",
                    ),
                ),
            ],
            options={
                "verbose_name": "Alert",
                "verbose_name_plural": "Alerts",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="AppealTemplate",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("template_id", models.CharField(db_index=True, max_length=50)),
                ("template_name", models.CharField(max_length=200)),
                ("denial_reason_code", models.CharField(blank=True, max_length=50)),
                (
                    "denial_reason_pattern",
                    models.CharField(
                        blank=True,
                        help_text="Regex pattern for denial reason text matching",
                        max_length=255,
                    ),
                ),
                (
                    "payer",
                    models.CharField(
                        blank=True,
                        help_text="Specific payer (if template is payer-specific)",
                        max_length=255,
                    ),
                ),
                (
                    "cpt_codes",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="CPT codes this template applies to",
                    ),
                ),
                (
                    "appeal_letter_template",
                    models.TextField(
                        help_text="Appeal letter template with {variable} placeholders"
                    ),
                ),
                (
                    "required_documentation",
                    models.JSONField(
                        default=list, help_text="List of required supporting documents"
                    ),
                ),
                ("times_used", models.IntegerField(default=0)),
                (
                    "success_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of successful appeals using this template",
                    ),
                ),
                (
                    "success_rate",
                    models.FloatField(
                        default=0.0,
                        help_text="Success rate (0-1)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                ("generated_by_ai", models.BooleanField(default=True)),
                (
                    "generation_confidence",
                    models.FloatField(
                        default=0.8,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                ("ai_model_version", models.CharField(default="gpt-4", max_length=50)),
                ("active", models.BooleanField(db_index=True, default=True)),
                (
                    "approved_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="approved_appeal_templates",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="appeal_templates",
                        to="upstream.customer",
                    ),
                ),
            ],
            options={
                "verbose_name": "Appeal Template",
                "verbose_name_plural": "Appeal Templates",
                "ordering": ["-success_rate", "-times_used"],
            },
        ),
        migrations.CreateModel(
            name="ClaimRecord",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("payer", models.TextField()),
                ("cpt", models.TextField()),
                ("cpt_group", models.TextField(default="OTHER")),
                ("submitted_date", models.DateField()),
                ("decided_date", models.DateField()),
                (
                    "outcome",
                    models.CharField(
                        choices=[
                            ("PAID", "Paid"),
                            ("DENIED", "Denied"),
                            ("OTHER", "Other"),
                        ],
                        max_length=20,
                    ),
                ),
                (
                    "allowed_amount",
                    models.DecimalField(
                        blank=True, decimal_places=2, max_digits=12, null=True
                    ),
                ),
                (
                    "denial_reason_code",
                    models.CharField(
                        blank=True,
                        help_text="Denial reason code from payer",
                        max_length=50,
                        null=True,
                    ),
                ),
                (
                    "denial_reason_text",
                    models.TextField(
                        blank=True, help_text="Denial reason description", null=True
                    ),
                ),
                (
                    "billed_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Original billed amount",
                        max_digits=12,
                        null=True,
                    ),
                ),
                (
                    "paid_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Amount actually paid (may differ from allowed)",
                        max_digits=12,
                        null=True,
                    ),
                ),
                (
                    "payment_date",
                    models.DateField(
                        blank=True,
                        help_text="Actual payment date (if different from decided_date)",
                        null=True,
                    ),
                ),
                (
                    "authorization_required",
                    models.BooleanField(
                        db_index=True,
                        default=False,
                        help_text="Whether prior auth was required",
                    ),
                ),
                (
                    "authorization_number",
                    models.CharField(blank=True, max_length=100, null=True),
                ),
                (
                    "authorization_obtained",
                    models.BooleanField(
                        default=False,
                        help_text="Whether auth was obtained before service",
                    ),
                ),
                (
                    "modifier_codes",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of modifier codes used",
                    ),
                ),
                (
                    "diagnosis_codes",
                    models.JSONField(
                        blank=True, default=list, help_text="List of diagnosis codes"
                    ),
                ),
                (
                    "procedure_count",
                    models.IntegerField(
                        default=1, help_text="Number of procedures on this claim"
                    ),
                ),
                (
                    "data_quality_score",
                    models.FloatField(
                        blank=True,
                        help_text="Quality score for this claim (0.0 = poor, 1.0 = perfect)",
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "data_quality_flags",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of quality issues: [{severity, message, field}]",
                    ),
                ),
                ("validation_passed", models.BooleanField(db_index=True, default=True)),
                ("validation_timestamp", models.DateTimeField(blank=True, null=True)),
                (
                    "processed_at",
                    models.DateTimeField(auto_now_add=True, db_index=True, null=True),
                ),
                ("updated_at", models.DateTimeField(auto_now=True, null=True)),
                (
                    "source_row_number",
                    models.IntegerField(
                        blank=True, help_text="Row number in source CSV file", null=True
                    ),
                ),
                (
                    "source_data_hash",
                    models.CharField(
                        blank=True,
                        help_text="SHA-256 hash of source row for deduplication",
                        max_length=64,
                        null=True,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="claim_records",
                        to="upstream.customer",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="AppealGeneration",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("appeal_id", models.CharField(db_index=True, max_length=50)),
                (
                    "appeal_letter",
                    models.TextField(help_text="Generated appeal letter content"),
                ),
                (
                    "required_documentation",
                    models.JSONField(
                        default=list, help_text="List of required supporting documents"
                    ),
                ),
                ("denial_reason", models.CharField(max_length=255)),
                (
                    "appeal_reason",
                    models.TextField(help_text="Reason/argument for appeal"),
                ),
                (
                    "supporting_evidence",
                    models.JSONField(
                        default=list, help_text="List of supporting evidence points"
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("draft", "Draft"),
                            ("ready", "Ready to Submit"),
                            ("submitted", "Submitted"),
                            ("under_review", "Under Review"),
                            ("approved", "Approved"),
                            ("denied", "Denied"),
                            ("abandoned", "Abandoned"),
                        ],
                        db_index=True,
                        default="draft",
                        max_length=20,
                    ),
                ),
                ("generated_at", models.DateTimeField(auto_now_add=True)),
                ("submitted_at", models.DateTimeField(blank=True, null=True)),
                ("decided_at", models.DateTimeField(blank=True, null=True)),
                (
                    "outcome",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("approved", "Appeal Approved"),
                            ("partial", "Partially Approved"),
                            ("denied", "Appeal Denied"),
                        ],
                        max_length=20,
                    ),
                ),
                (
                    "recovered_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Amount recovered from successful appeal",
                        max_digits=12,
                        null=True,
                    ),
                ),
                (
                    "generation_confidence",
                    models.FloatField(
                        default=0.8,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                ("ai_model_version", models.CharField(default="gpt-4", max_length=50)),
                (
                    "edited_by_user",
                    models.BooleanField(
                        default=False,
                        help_text="Whether user manually edited the generated appeal",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "template_used",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="generated_appeals",
                        to="upstream.appealtemplate",
                    ),
                ),
                (
                    "claim_record",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="appeals",
                        to="upstream.claimrecord",
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="appeal_generations",
                        to="upstream.customer",
                    ),
                ),
            ],
            options={
                "verbose_name": "Appeal Generation",
                "verbose_name_plural": "Appeal Generations",
                "ordering": ["-generated_at"],
            },
        ),
        migrations.CreateModel(
            name="DataQualityMetric",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "metric_type",
                    models.CharField(
                        choices=[
                            ("completeness", "Completeness"),
                            ("accuracy", "Accuracy"),
                            ("consistency", "Consistency"),
                            ("timeliness", "Timeliness"),
                            ("validity", "Validity"),
                            ("uniqueness", "Uniqueness"),
                        ],
                        db_index=True,
                        max_length=30,
                    ),
                ),
                (
                    "metric_name",
                    models.CharField(help_text="Specific metric name", max_length=100),
                ),
                ("measurement_date", models.DateField(db_index=True)),
                (
                    "measurement_timestamp",
                    models.DateTimeField(default=django.utils.timezone.now),
                ),
                (
                    "score",
                    models.FloatField(
                        help_text="Quality score from 0.0 (worst) to 1.0 (perfect)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "sample_size",
                    models.IntegerField(help_text="Number of records measured"),
                ),
                (
                    "passed_count",
                    models.IntegerField(
                        help_text="Number of records passing quality check"
                    ),
                ),
                (
                    "failed_count",
                    models.IntegerField(
                        help_text="Number of records failing quality check"
                    ),
                ),
                (
                    "entity_type",
                    models.CharField(
                        default="claim_record",
                        help_text="Type of entity measured (claim_record, upload, etc.)",
                        max_length=50,
                    ),
                ),
                (
                    "dimension",
                    models.CharField(
                        blank=True,
                        help_text="Optional dimension (payer, cpt_group, etc.)",
                        max_length=100,
                    ),
                ),
                (
                    "dimension_value",
                    models.CharField(
                        blank=True,
                        help_text="Value of the dimension (if applicable)",
                        max_length=255,
                    ),
                ),
                (
                    "details",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Detailed breakdown and supporting metrics",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="quality_metrics",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Data Quality Metric",
                "verbose_name_plural": "Data Quality Metrics",
                "ordering": ["-measurement_date", "-measurement_timestamp"],
            },
        ),
        migrations.CreateModel(
            name="DenialAggregate",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("payer", models.CharField(db_index=True, max_length=255)),
                (
                    "denial_reason",
                    models.CharField(
                        blank=True,
                        help_text='Denial reason code or generic "DENIED"',
                        max_length=255,
                        null=True,
                    ),
                ),
                (
                    "cpt_code",
                    models.CharField(
                        blank=True,
                        help_text="Optional CPT code filter",
                        max_length=50,
                        null=True,
                    ),
                ),
                (
                    "aggregate_date",
                    models.DateField(db_index=True, help_text="Day of aggregation"),
                ),
                ("denied_count", models.IntegerField(default=0)),
                (
                    "denied_dollars",
                    models.DecimalField(
                        decimal_places=2,
                        default=0,
                        help_text="Sum of allowed_amount for denials",
                        max_digits=12,
                    ),
                ),
                (
                    "total_submitted_count",
                    models.IntegerField(
                        default=0,
                        help_text="Total claims submitted to this payer on this day",
                    ),
                ),
                (
                    "total_submitted_dollars",
                    models.DecimalField(decimal_places=2, default=0, max_digits=12),
                ),
                (
                    "denial_rate",
                    models.FloatField(
                        default=0.0,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="denial_aggregates",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Denial Aggregate",
                "verbose_name_plural": "Denial Aggregates",
                "ordering": ["-aggregate_date", "-denied_count"],
            },
        ),
        migrations.CreateModel(
            name="DenialCascade",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("cascade_id", models.CharField(db_index=True, max_length=50)),
                (
                    "cascade_type",
                    models.CharField(
                        choices=[
                            ("temporal", "Temporal - Same timeframe"),
                            ("procedural", "Procedural - Related procedures"),
                            ("payer_systemic", "Payer Systemic - Payer-wide issue"),
                            ("documentation", "Documentation - Same doc issue"),
                        ],
                        default="temporal",
                        max_length=50,
                    ),
                ),
                (
                    "claim_ids",
                    models.JSONField(
                        default=list,
                        help_text="List of ClaimRecord IDs in this cascade",
                    ),
                ),
                ("claim_count", models.IntegerField(default=0)),
                ("payer", models.CharField(max_length=255)),
                ("denial_reasons", models.JSONField(default=list)),
                (
                    "total_denied_dollars",
                    models.DecimalField(decimal_places=2, default=0, max_digits=12),
                ),
                (
                    "confidence_score",
                    models.FloatField(
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ]
                    ),
                ),
                (
                    "pattern_summary",
                    models.TextField(help_text="Description of the cascade pattern"),
                ),
                (
                    "root_cause",
                    models.TextField(
                        blank=True, help_text="Identified or suspected root cause"
                    ),
                ),
                (
                    "resolution_recommended",
                    models.TextField(
                        blank=True, help_text="Recommended resolution strategy"
                    ),
                ),
                ("resolved", models.BooleanField(db_index=True, default=False)),
                ("cascade_start_date", models.DateField()),
                ("cascade_end_date", models.DateField()),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="denial_cascades",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Denial Cascade",
                "verbose_name_plural": "Denial Cascades",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="DenialCluster",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "cluster_id",
                    models.CharField(
                        db_index=True,
                        help_text="Unique cluster identifier (e.g., CLU-2024-001)",
                        max_length=50,
                    ),
                ),
                (
                    "cluster_name",
                    models.CharField(
                        help_text="Human-readable cluster name", max_length=200
                    ),
                ),
                ("primary_denial_reason", models.CharField(max_length=255)),
                (
                    "secondary_denial_reasons",
                    models.JSONField(
                        default=list, help_text="Other denial reasons in this cluster"
                    ),
                ),
                (
                    "payers",
                    models.JSONField(
                        default=list, help_text="List of payers in this cluster"
                    ),
                ),
                (
                    "cpt_codes",
                    models.JSONField(
                        default=list, help_text="List of CPT codes in this cluster"
                    ),
                ),
                ("claim_count", models.IntegerField(default=0)),
                (
                    "total_denied_dollars",
                    models.DecimalField(decimal_places=2, default=0, max_digits=12),
                ),
                (
                    "cluster_confidence",
                    models.FloatField(
                        help_text="Confidence score for cluster cohesion (0-1)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "silhouette_score",
                    models.FloatField(
                        blank=True,
                        help_text="ML silhouette score for cluster quality",
                        null=True,
                    ),
                ),
                (
                    "pattern_description",
                    models.TextField(
                        help_text="AI-generated description of the denial pattern"
                    ),
                ),
                (
                    "root_cause_hypothesis",
                    models.TextField(
                        help_text="AI-generated hypothesis about root cause"
                    ),
                ),
                (
                    "resolution_strategy",
                    models.TextField(
                        blank=True,
                        help_text="Recommended resolution strategy for this cluster",
                    ),
                ),
                ("resolved", models.BooleanField(db_index=True, default=False)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                ("first_denial_date", models.DateField()),
                ("last_denial_date", models.DateField()),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="denial_clusters",
                        to="upstream.customer",
                    ),
                ),
                (
                    "resolved_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="resolved_denial_clusters",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Denial Cluster",
                "verbose_name_plural": "Denial Clusters",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="DenialSignal",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "signal_type",
                    models.CharField(
                        choices=[
                            ("new_denial_reason", "New Denial Reason"),
                            ("denial_rate_spike", "Denial Rate Spike"),
                            ("denial_volume_spike", "Denial Volume Spike"),
                            ("denial_dollars_spike", "Denial Dollars Spike"),
                        ],
                        db_index=True,
                        max_length=50,
                    ),
                ),
                ("payer", models.CharField(db_index=True, max_length=255)),
                (
                    "denial_reason",
                    models.CharField(blank=True, max_length=255, null=True),
                ),
                ("window_start_date", models.DateField()),
                ("window_end_date", models.DateField()),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("low", "Low"),
                            ("medium", "Medium"),
                            ("high", "High"),
                            ("critical", "Critical"),
                        ],
                        db_index=True,
                        default="medium",
                        max_length=20,
                    ),
                ),
                (
                    "confidence",
                    models.FloatField(
                        help_text="Confidence score 0-1",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "summary_text",
                    models.TextField(help_text="Human-readable signal summary"),
                ),
                (
                    "details",
                    models.JSONField(
                        default=dict, help_text="Signal-specific metrics and context"
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="denial_signals",
                        to="upstream.customer",
                    ),
                ),
                (
                    "related_aggregates",
                    models.ManyToManyField(
                        blank=True,
                        related_name="signals",
                        to="upstream.denialaggregate",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Denial Signal",
                "verbose_name_plural": "Denial Signals",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="DomainAuditEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "action",
                    models.CharField(
                        choices=[
                            ("upload_created", "Upload Created"),
                            ("report_exported", "Report Exported"),
                            ("alert_rule_created", "Alert Rule Created"),
                            ("alert_rule_updated", "Alert Rule Updated"),
                            ("alert_rule_deleted", "Alert Rule Deleted"),
                            ("alert_event_created", "Alert Event Created"),
                            ("alert_event_sent", "Alert Event Sent"),
                            ("alert_event_failed", "Alert Event Failed"),
                            (
                                "webhook_delivery_attempted",
                                "Webhook Delivery Attempted",
                            ),
                            ("webhook_delivery_sent", "Webhook Delivery Sent"),
                            ("webhook_delivery_failed", "Webhook Delivery Failed"),
                            ("webhook_endpoint_created", "Webhook Endpoint Created"),
                            ("webhook_endpoint_updated", "Webhook Endpoint Updated"),
                            ("webhook_endpoint_deleted", "Webhook Endpoint Deleted"),
                            ("drift_event_created", "Drift Event Created"),
                            ("report_run_started", "Report Run Started"),
                            ("report_run_completed", "Report Run Completed"),
                            ("member_added", "Member Added"),
                            ("member_removed", "Member Removed"),
                            ("role_changed", "Role Changed"),
                            ("alert_routing_updated", "Alert Routing Updated"),
                            ("slack_webhook_updated", "Slack Webhook Updated"),
                        ],
                        max_length=50,
                    ),
                ),
                ("entity_type", models.CharField(max_length=100)),
                ("entity_id", models.CharField(blank=True, max_length=100, null=True)),
                ("timestamp", models.DateTimeField(auto_now_add=True)),
                ("request_id", models.CharField(blank=True, max_length=64, null=True)),
                ("metadata", models.JSONField(blank=True, default=dict)),
                (
                    "customer",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="domain_audit_events",
                        to="upstream.customer",
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="domain_audit_events",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Domain Audit Event",
                "verbose_name_plural": "Domain Audit Events",
                "ordering": ["-timestamp"],
            },
        ),
        migrations.CreateModel(
            name="DriftEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("payer", models.TextField()),
                ("cpt_group", models.TextField()),
                (
                    "drift_type",
                    models.CharField(
                        choices=[
                            ("DENIAL_RATE", "Denial Rate"),
                            ("DECISION_TIME", "Decision Time"),
                            ("PAYMENT_AMOUNT", "Payment Amount"),
                            ("APPROVAL_RATE", "Approval Rate"),
                            ("PROCESSING_DELAY", "Processing Delay"),
                            ("AUTH_FAILURE_RATE", "Authorization Failure Rate"),
                        ],
                        max_length=30,
                    ),
                ),
                ("baseline_value", models.FloatField()),
                ("current_value", models.FloatField()),
                ("delta_value", models.FloatField()),
                (
                    "severity",
                    models.FloatField(
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ]
                    ),
                ),
                (
                    "confidence",
                    models.FloatField(
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ]
                    ),
                ),
                ("baseline_start", models.DateField()),
                ("baseline_end", models.DateField()),
                ("current_start", models.DateField()),
                ("current_end", models.DateField()),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "baseline_sample_size",
                    models.IntegerField(
                        default=0, help_text="Number of claims in baseline period"
                    ),
                ),
                (
                    "current_sample_size",
                    models.IntegerField(
                        default=0, help_text="Number of claims in current period"
                    ),
                ),
                (
                    "baseline_std_dev",
                    models.FloatField(
                        blank=True,
                        help_text="Standard deviation of baseline",
                        null=True,
                    ),
                ),
                (
                    "statistical_significance",
                    models.FloatField(
                        blank=True,
                        help_text="P-value from statistical test (lower = more significant)",
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "estimated_revenue_impact",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Estimated monthly revenue impact of this drift",
                        max_digits=12,
                        null=True,
                    ),
                ),
                (
                    "trend_direction",
                    models.CharField(
                        choices=[
                            ("improving", "Improving"),
                            ("degrading", "Degrading"),
                            ("stable", "Stable"),
                        ],
                        db_index=True,
                        default="stable",
                        max_length=20,
                    ),
                ),
                (
                    "consecutive_periods",
                    models.IntegerField(
                        default=1,
                        help_text="Number of consecutive periods this drift has persisted",
                    ),
                ),
                (
                    "potential_root_causes",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="AI-suggested root causes: [{cause, likelihood}]",
                    ),
                ),
                (
                    "suppressed",
                    models.BooleanField(
                        db_index=True,
                        default=False,
                        help_text="Whether this event was suppressed from alerting",
                    ),
                ),
                (
                    "suppression_reason",
                    models.TextField(
                        blank=True, help_text="Why this event was suppressed"
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="drift_events",
                        to="upstream.customer",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="AlertEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "triggered_at",
                    models.DateTimeField(default=django.utils.timezone.now),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending"),
                            ("sent", "Sent"),
                            ("failed", "Failed"),
                            ("acknowledged", "Acknowledged"),
                            ("resolved", "Resolved"),
                        ],
                        default="pending",
                        max_length=20,
                    ),
                ),
                ("payload", models.JSONField(blank=True, default=dict)),
                ("notification_sent_at", models.DateTimeField(blank=True, null=True)),
                ("error_message", models.TextField(blank=True, null=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "alert_rule",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="events",
                        to="upstream.alertrule",
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="alert_events",
                        to="upstream.customer",
                    ),
                ),
                (
                    "drift_event",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="alert_events",
                        to="upstream.driftevent",
                    ),
                ),
            ],
            options={
                "verbose_name": "Alert Event",
                "verbose_name_plural": "Alert Events",
                "ordering": ["-triggered_at"],
            },
        ),
        migrations.CreateModel(
            name="IngestionRecord",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "source_type",
                    models.CharField(
                        choices=[
                            ("batch_upload", "Batch Upload"),
                            ("webhook", "Webhook"),
                            ("api", "API"),
                            ("streaming", "Streaming"),
                        ],
                        max_length=50,
                    ),
                ),
                (
                    "idempotency_key",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        help_text="Unique key to prevent duplicate processing",
                        max_length=255,
                        null=True,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending"),
                            ("processing", "Processing"),
                            ("processed", "Processed"),
                            ("failed", "Failed"),
                        ],
                        db_index=True,
                        default="pending",
                        max_length=20,
                    ),
                ),
                (
                    "payload_metadata",
                    models.JSONField(
                        default=dict, help_text="Metadata about the ingested payload"
                    ),
                ),
                (
                    "record_count",
                    models.IntegerField(
                        blank=True, help_text="Number of records in payload", null=True
                    ),
                ),
                ("error_message", models.TextField(blank=True, null=True)),
                ("processed_at", models.DateTimeField(blank=True, null=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="ingestions_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="ingestion_records",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Ingestion Record",
                "verbose_name_plural": "Ingestion Records",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="IngestionToken",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "name",
                    models.CharField(
                        help_text="Friendly name for this token", max_length=100
                    ),
                ),
                ("token", models.CharField(db_index=True, max_length=64, unique=True)),
                ("is_active", models.BooleanField(default=True)),
                ("last_used_at", models.DateTimeField(blank=True, null=True)),
                (
                    "expires_at",
                    models.DateTimeField(
                        blank=True, help_text="Optional expiration date", null=True
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="ingestion_tokens",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Ingestion Token",
                "verbose_name_plural": "Ingestion Tokens",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="IntegrationConnection",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100)),
                (
                    "connection_type",
                    models.CharField(
                        choices=[
                            ("api", "REST API"),
                            ("sftp", "SFTP"),
                            ("database", "Direct Database"),
                            ("webhook", "Webhook"),
                            ("file", "File Exchange"),
                        ],
                        max_length=50,
                    ),
                ),
                ("base_url", models.URLField(blank=True, null=True)),
                ("credentials", models.JSONField(blank=True, null=True)),
                ("configuration", models.JSONField(blank=True, null=True)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("active", "Active"),
                            ("inactive", "Inactive"),
                            ("testing", "Testing"),
                            ("failed", "Failed"),
                        ],
                        default="testing",
                        max_length=20,
                    ),
                ),
                ("last_successful_sync", models.DateTimeField(blank=True, null=True)),
                ("last_error_message", models.TextField(blank=True, null=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Integration Connection",
                "verbose_name_plural": "Integration Connections",
            },
        ),
        migrations.CreateModel(
            name="IntegrationLog",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "operation_type",
                    models.CharField(
                        choices=[
                            ("sync", "Data Synchronization"),
                            ("query", "Data Query"),
                            ("push", "Data Push"),
                            ("pull", "Data Pull"),
                            ("test", "Connection Test"),
                        ],
                        max_length=50,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("success", "Success"),
                            ("failed", "Failed"),
                            ("partial", "Partial Success"),
                            ("timeout", "Timeout"),
                        ],
                        max_length=20,
                    ),
                ),
                ("records_processed", models.IntegerField(default=0)),
                ("start_time", models.DateTimeField(auto_now_add=True)),
                ("end_time", models.DateTimeField(blank=True, null=True)),
                ("error_message", models.TextField(blank=True, null=True)),
                ("request_payload", models.JSONField(blank=True, null=True)),
                ("response_payload", models.JSONField(blank=True, null=True)),
                (
                    "connection",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to="upstream.integrationconnection",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Integration Log",
                "verbose_name_plural": "Integration Logs",
                "ordering": ["-start_time"],
            },
        ),
        migrations.CreateModel(
            name="IntegrationProvider",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100, unique=True)),
                (
                    "provider_type",
                    models.CharField(
                        choices=[
                            ("ehr", "Electronic Health Record"),
                            ("practice_management", "Practice Management"),
                            ("billing", "Billing System"),
                            ("payer", "Payer System"),
                            ("analytics", "Analytics Platform"),
                            ("communication", "Communication Platform"),
                            ("other", "Other"),
                        ],
                        max_length=50,
                    ),
                ),
                ("description", models.TextField(blank=True, null=True)),
                ("api_documentation_url", models.URLField(blank=True, null=True)),
                ("is_active", models.BooleanField(default=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Integration Provider",
                "verbose_name_plural": "Integration Providers",
            },
        ),
        migrations.AddField(
            model_name="integrationconnection",
            name="provider",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                to="upstream.integrationprovider",
            ),
        ),
        migrations.CreateModel(
            name="NotificationChannel",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100)),
                (
                    "channel_type",
                    models.CharField(
                        choices=[
                            ("email", "Email"),
                            ("webhook", "Webhook"),
                            ("slack", "Slack"),
                        ],
                        default="email",
                        max_length=20,
                    ),
                ),
                (
                    "config",
                    models.JSONField(
                        default=dict, help_text="Channel-specific configuration"
                    ),
                ),
                ("enabled", models.BooleanField(default=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="notification_channels",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Notification Channel",
                "verbose_name_plural": "Notification Channels",
            },
        ),
        migrations.AddField(
            model_name="alertrule",
            name="routing_channels",
            field=models.ManyToManyField(
                blank=True,
                help_text="Specific channels to route this alert to. If empty, uses all enabled channels.",
                related_name="alert_rules",
                to="upstream.notificationchannel",
            ),
        ),
        migrations.CreateModel(
            name="OperatorJudgment",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "verdict",
                    models.CharField(
                        choices=[
                            ("noise", "Noise"),
                            ("real", "Real/Legitimate"),
                            ("needs_followup", "Needs Follow-up"),
                        ],
                        help_text="Operator verdict on the alert",
                        max_length=20,
                    ),
                ),
                (
                    "reason_codes_json",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of reason codes or tags explaining the judgment",
                    ),
                ),
                (
                    "recovered_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Dollar amount recovered from this alert (if applicable)",
                        max_digits=12,
                        null=True,
                    ),
                ),
                (
                    "recovered_date",
                    models.DateField(
                        blank=True,
                        help_text="Date when recovery was confirmed",
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(blank=True, help_text="Optional operator notes"),
                ),
                (
                    "alert_event",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="operator_judgments",
                        to="upstream.alertevent",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="operator_judgments",
                        to="upstream.customer",
                    ),
                ),
                (
                    "operator",
                    models.ForeignKey(
                        help_text="Operator who made the judgment",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="operator_judgments",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Operator Judgment",
                "verbose_name_plural": "Operator Judgments",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PayerMapping",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("raw_name", models.CharField(max_length=255)),
                ("normalized_name", models.CharField(max_length=255)),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payer_mappings",
                        to="upstream.customer",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="PaymentDelayAggregate",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("payer", models.CharField(db_index=True, max_length=255)),
                (
                    "aggregate_date",
                    models.DateField(db_index=True, help_text="Day of aggregation"),
                ),
                (
                    "claim_count",
                    models.IntegerField(
                        default=0, help_text="Total claims with valid dates"
                    ),
                ),
                (
                    "total_days_to_payment",
                    models.IntegerField(default=0, help_text="Sum of days to payment"),
                ),
                (
                    "avg_days_to_payment",
                    models.FloatField(default=0.0, help_text="Average days to payment"),
                ),
                (
                    "min_days_to_payment",
                    models.IntegerField(
                        blank=True, help_text="Minimum days to payment", null=True
                    ),
                ),
                (
                    "max_days_to_payment",
                    models.IntegerField(
                        blank=True, help_text="Maximum days to payment", null=True
                    ),
                ),
                (
                    "total_billed_amount",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Sum of allowed_amount for included claims",
                        max_digits=14,
                    ),
                ),
                (
                    "total_rows_evaluated",
                    models.IntegerField(
                        default=0, help_text="Total rows including missing dates"
                    ),
                ),
                (
                    "rows_with_valid_dates",
                    models.IntegerField(
                        default=0,
                        help_text="Rows with both submitted and decided dates",
                    ),
                ),
                (
                    "date_completeness_ratio",
                    models.FloatField(
                        default=0.0,
                        help_text="Ratio of valid rows to total rows",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payment_delay_aggregates",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Payment Delay Aggregate",
                "verbose_name_plural": "Payment Delay Aggregates",
                "ordering": ["-aggregate_date", "-claim_count"],
            },
        ),
        migrations.CreateModel(
            name="PaymentDelayClaimSet",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("payer", models.CharField(max_length=255)),
                ("window_start_date", models.DateField()),
                ("window_end_date", models.DateField()),
                (
                    "row_count",
                    models.IntegerField(help_text="Number of claims in this set"),
                ),
                (
                    "totals_json",
                    models.JSONField(
                        default=dict, help_text="Aggregate totals for the claim set"
                    ),
                ),
                (
                    "source_refs_json",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of claim IDs or surrogate keys",
                    ),
                ),
                (
                    "fingerprint",
                    models.CharField(
                        db_index=True,
                        help_text="SHA256 of sorted claim IDs",
                        max_length=255,
                    ),
                ),
                ("frozen_at", models.DateTimeField(auto_now_add=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payment_delay_claimsets",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Payment Delay Claim Set",
                "verbose_name_plural": "Payment Delay Claim Sets",
                "ordering": ["-frozen_at"],
            },
        ),
        migrations.CreateModel(
            name="PaymentDelaySignal",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "signal_type",
                    models.CharField(
                        choices=[("payment_delay_drift", "Payment Delay Drift")],
                        db_index=True,
                        max_length=50,
                    ),
                ),
                ("payer", models.CharField(db_index=True, max_length=255)),
                ("window_start_date", models.DateField()),
                ("window_end_date", models.DateField()),
                ("baseline_start_date", models.DateField()),
                ("baseline_end_date", models.DateField()),
                (
                    "baseline_avg_days",
                    models.FloatField(help_text="Baseline average days to payment"),
                ),
                (
                    "current_avg_days",
                    models.FloatField(
                        help_text="Current window average days to payment"
                    ),
                ),
                (
                    "delta_days",
                    models.FloatField(help_text="Change in days (positive = slower)"),
                ),
                (
                    "delta_percent",
                    models.FloatField(help_text="Percentage change from baseline"),
                ),
                (
                    "baseline_claim_count",
                    models.IntegerField(help_text="Claims in baseline window"),
                ),
                (
                    "current_claim_count",
                    models.IntegerField(help_text="Claims in current window"),
                ),
                (
                    "estimated_dollars_at_risk",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Estimated cash impact from delayed payments",
                        max_digits=14,
                        null=True,
                    ),
                ),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("low", "Low"),
                            ("medium", "Medium"),
                            ("high", "High"),
                            ("critical", "Critical"),
                        ],
                        db_index=True,
                        default="medium",
                        max_length=20,
                    ),
                ),
                (
                    "confidence",
                    models.FloatField(
                        help_text="Confidence score 0-1 based on sample size and data quality",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "summary_text",
                    models.TextField(help_text="Human-readable signal summary"),
                ),
                (
                    "details",
                    models.JSONField(
                        default=dict, help_text="Signal-specific metrics and context"
                    ),
                ),
                (
                    "fingerprint",
                    models.CharField(
                        db_index=True,
                        help_text="Deterministic fingerprint of query criteria",
                        max_length=255,
                    ),
                ),
                (
                    "data_quality_warnings",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of data quality issues encountered",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payment_delay_signals",
                        to="upstream.customer",
                    ),
                ),
                (
                    "related_aggregates",
                    models.ManyToManyField(
                        blank=True,
                        related_name="signals",
                        to="upstream.paymentdelayaggregate",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Payment Delay Signal",
                "verbose_name_plural": "Payment Delay Signals",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PaymentDelayEvidenceArtifact",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "payload_json",
                    models.JSONField(
                        default=dict, help_text="Structured evidence payload"
                    ),
                ),
                ("generated_at", models.DateTimeField(auto_now_add=True)),
                (
                    "generation_duration_ms",
                    models.IntegerField(
                        blank=True,
                        help_text="Time to generate in milliseconds",
                        null=True,
                    ),
                ),
                (
                    "claimset",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="evidence_artifacts",
                        to="upstream.paymentdelayclaimset",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="payment_delay_evidence",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "signal",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="evidence_artifacts",
                        to="upstream.paymentdelaysignal",
                    ),
                ),
            ],
            options={
                "verbose_name": "Payment Delay Evidence Artifact",
                "verbose_name_plural": "Payment Delay Evidence Artifacts",
                "ordering": ["-generated_at"],
            },
        ),
        migrations.AddField(
            model_name="paymentdelayclaimset",
            name="signal",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="claimsets",
                to="upstream.paymentdelaysignal",
            ),
        ),
        migrations.AddField(
            model_name="alertevent",
            name="payment_delay_signal",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                related_name="alert_events",
                to="upstream.paymentdelaysignal",
            ),
        ),
        migrations.CreateModel(
            name="PreDenialWarning",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("warning_id", models.CharField(db_index=True, max_length=50)),
                (
                    "warning_type",
                    models.CharField(
                        choices=[
                            ("auth_missing", "Authorization Missing"),
                            ("doc_incomplete", "Documentation Incomplete"),
                            ("coding_error", "Coding Error Likely"),
                            ("policy_violation", "Policy Violation Risk"),
                            ("payer_pattern", "Payer Pattern Match"),
                        ],
                        max_length=50,
                    ),
                ),
                ("predicted_denial_reason", models.CharField(max_length=255)),
                (
                    "denial_probability",
                    models.FloatField(
                        help_text="Predicted probability of denial (0-1)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "confidence_score",
                    models.FloatField(
                        help_text="Model confidence in prediction",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "risk_factors",
                    models.JSONField(
                        default=list,
                        help_text="List of identified risk factors: [{factor, weight}]",
                    ),
                ),
                ("payer", models.CharField(max_length=255)),
                ("cpt_code", models.CharField(blank=True, max_length=50)),
                (
                    "estimated_claim_value",
                    models.DecimalField(
                        blank=True, decimal_places=2, max_digits=12, null=True
                    ),
                ),
                (
                    "recommended_actions",
                    models.JSONField(
                        default=list,
                        help_text="Recommended actions to prevent denial: [{action, priority}]",
                    ),
                ),
                (
                    "intervention_deadline",
                    models.DateField(
                        blank=True, help_text="Deadline for intervention", null=True
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("active", "Active"),
                            ("intervened", "Intervention Taken"),
                            ("expired", "Expired"),
                            ("confirmed", "Denial Confirmed"),
                            ("avoided", "Denial Avoided"),
                        ],
                        db_index=True,
                        default="active",
                        max_length=20,
                    ),
                ),
                (
                    "actual_outcome",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("paid", "Paid"),
                            ("denied", "Denied"),
                            ("pending", "Pending"),
                        ],
                        help_text="Actual claim outcome (for model feedback)",
                        max_length=20,
                    ),
                ),
                (
                    "intervention_taken",
                    models.TextField(
                        blank=True, help_text="Description of intervention taken"
                    ),
                ),
                (
                    "model_version",
                    models.CharField(
                        default="v1.0",
                        help_text="ML model version used for prediction",
                        max_length=50,
                    ),
                ),
                (
                    "prediction_features",
                    models.JSONField(
                        default=dict,
                        help_text="Features used in prediction (for explainability)",
                    ),
                ),
                (
                    "claim_record",
                    models.ForeignKey(
                        blank=True,
                        help_text="Specific claim at risk (if available)",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="pre_denial_warnings",
                        to="upstream.claimrecord",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="pre_denial_warnings",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Pre-Denial Warning",
                "verbose_name_plural": "Pre-Denial Warnings",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="ProductConfig",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "product_slug",
                    models.CharField(
                        choices=[
                            ("upstream-core", "Upstream Core"),
                            ("denialscope", "DenialScope"),
                            ("contractiq", "ContractIQ"),
                            ("opsvariance", "OpsVariance"),
                            ("authsignal", "AuthSignal"),
                        ],
                        max_length=50,
                    ),
                ),
                ("enabled", models.BooleanField(default=False)),
                (
                    "config_json",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Product-specific configuration",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="product_configs",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Product Configuration",
                "verbose_name_plural": "Product Configurations",
                "ordering": ["customer", "product_slug"],
            },
        ),
        migrations.CreateModel(
            name="ReportRun",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "run_type",
                    models.CharField(
                        choices=[
                            ("weekly", "Weekly"),
                            ("monthly", "Monthly"),
                            ("custom", "Custom"),
                        ],
                        default="weekly",
                        max_length=20,
                    ),
                ),
                ("started_at", models.DateTimeField(auto_now_add=True)),
                ("finished_at", models.DateTimeField(blank=True, null=True)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("running", "Running"),
                            ("success", "Success"),
                            ("failed", "Failed"),
                        ],
                        default="running",
                        max_length=20,
                    ),
                ),
                ("summary_json", models.JSONField(blank=True, null=True)),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="report_runs",
                        to="upstream.customer",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="ReportArtifact",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "kind",
                    models.CharField(
                        default="weekly_drift_summary",
                        help_text="Type of report artifact (e.g., weekly_drift_summary)",
                        max_length=50,
                    ),
                ),
                (
                    "file_path",
                    models.CharField(
                        blank=True,
                        help_text="Path to the generated PDF file",
                        max_length=512,
                    ),
                ),
                (
                    "content_hash",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="SHA256 hash of file content for idempotency",
                        max_length=64,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When the artifact was generated"
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="report_artifacts",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "report_run",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="artifacts",
                        to="upstream.reportrun",
                    ),
                ),
            ],
            options={
                "verbose_name": "Report Artifact",
                "verbose_name_plural": "Report Artifacts",
            },
        ),
        migrations.AddField(
            model_name="driftevent",
            name="report_run",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="drift_events",
                to="upstream.reportrun",
            ),
        ),
        migrations.AddField(
            model_name="alertevent",
            name="report_run",
            field=models.ForeignKey(
                blank=True,
                null=True,
                on_delete=django.db.models.deletion.CASCADE,
                related_name="alert_events",
                to="upstream.reportrun",
            ),
        ),
        migrations.CreateModel(
            name="ReportTemplate",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100, unique=True)),
                ("description", models.TextField()),
                (
                    "template_type",
                    models.CharField(
                        choices=[
                            ("pdf", "PDF Report"),
                            ("csv", "CSV Export"),
                            ("excel", "Excel Spreadsheet"),
                            ("html", "HTML Report"),
                        ],
                        max_length=50,
                    ),
                ),
                ("template_file", models.FileField(upload_to="report_templates/")),
                (
                    "output_format",
                    models.CharField(
                        choices=[
                            ("pdf", "PDF"),
                            ("csv", "CSV"),
                            ("xlsx", "Excel"),
                            ("html", "HTML"),
                        ],
                        max_length=20,
                    ),
                ),
                ("is_active", models.BooleanField(default=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Report Template",
                "verbose_name_plural": "Report Templates",
            },
        ),
        migrations.CreateModel(
            name="ScheduledReport",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "schedule_type",
                    models.CharField(
                        choices=[
                            ("daily", "Daily"),
                            ("weekly", "Weekly"),
                            ("monthly", "Monthly"),
                            ("quarterly", "Quarterly"),
                            ("one_time", "One Time"),
                        ],
                        max_length=20,
                    ),
                ),
                ("next_run_date", models.DateTimeField()),
                ("last_run_date", models.DateTimeField(blank=True, null=True)),
                (
                    "last_run_status",
                    models.CharField(
                        blank=True,
                        choices=[
                            ("success", "Success"),
                            ("failed", "Failed"),
                            ("pending", "Pending"),
                        ],
                        max_length=20,
                        null=True,
                    ),
                ),
                ("recipients", models.JSONField(default=list)),
                ("parameters", models.JSONField(default=dict)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "template",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        to="upstream.reporttemplate",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Scheduled Report",
                "verbose_name_plural": "Scheduled Reports",
            },
        ),
        migrations.CreateModel(
            name="Settings",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("to_email", models.EmailField(max_length=254)),
                ("cc_email", models.EmailField(blank=True, max_length=254, null=True)),
                ("attach_pdf", models.BooleanField(default=True)),
                (
                    "customer",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="settings",
                        to="upstream.customer",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="SystemEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "event_type",
                    models.CharField(
                        choices=[
                            ("ingestion_received", "Ingestion Received"),
                            ("ingestion_processed", "Ingestion Processed"),
                            ("ingestion_failed", "Ingestion Failed"),
                            ("drift_detected", "Drift Detected"),
                            ("alert_created", "Alert Created"),
                            ("export_generated", "Export Generated"),
                            ("report_generated", "Report Generated"),
                            ("webhook_sent", "Webhook Sent"),
                            ("email_sent", "Email Sent"),
                            (
                                "denialscope_signal_created",
                                "DenialScope Signal Created",
                            ),
                        ],
                        db_index=True,
                        max_length=50,
                    ),
                ),
                (
                    "payload",
                    models.JSONField(default=dict, help_text="Event-specific data"),
                ),
                (
                    "request_id",
                    models.CharField(
                        blank=True, db_index=True, max_length=100, null=True
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="system_events",
                        to="upstream.customer",
                    ),
                ),
                (
                    "related_alert",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="system_events",
                        to="upstream.alertevent",
                    ),
                ),
                (
                    "related_drift_event",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="system_events",
                        to="upstream.driftevent",
                    ),
                ),
                (
                    "related_ingestion",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="events",
                        to="upstream.ingestionrecord",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "System Event",
                "verbose_name_plural": "System Events",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="Upload",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("uploaded_at", models.DateTimeField(auto_now_add=True)),
                ("filename", models.CharField(max_length=255)),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("processing", "Processing"),
                            ("success", "Success"),
                            ("failed", "Failed"),
                            ("partial", "Partial Success"),
                        ],
                        default="processing",
                        max_length=20,
                    ),
                ),
                ("error_message", models.TextField(blank=True, null=True)),
                ("row_count", models.IntegerField(blank=True, null=True)),
                ("date_min", models.DateField(blank=True, null=True)),
                ("date_max", models.DateField(blank=True, null=True)),
                ("processing_started_at", models.DateTimeField(blank=True, null=True)),
                (
                    "processing_completed_at",
                    models.DateTimeField(blank=True, null=True),
                ),
                (
                    "processing_duration_seconds",
                    models.IntegerField(
                        blank=True, help_text="Time taken to process upload", null=True
                    ),
                ),
                (
                    "accepted_row_count",
                    models.IntegerField(
                        default=0, help_text="Number of rows that passed validation"
                    ),
                ),
                (
                    "rejected_row_count",
                    models.IntegerField(
                        default=0, help_text="Number of rows that failed validation"
                    ),
                ),
                (
                    "warning_row_count",
                    models.IntegerField(
                        default=0, help_text="Number of rows with warnings"
                    ),
                ),
                ("file_size_bytes", models.BigIntegerField(blank=True, null=True)),
                (
                    "file_hash",
                    models.CharField(
                        blank=True,
                        help_text="SHA-256 hash for deduplication",
                        max_length=64,
                        null=True,
                    ),
                ),
                (
                    "file_encoding",
                    models.CharField(
                        blank=True, default="utf-8", max_length=50, null=True
                    ),
                ),
                (
                    "upload_source",
                    models.CharField(
                        choices=[
                            ("web_ui", "Web UI"),
                            ("api", "API"),
                            ("batch", "Batch Process"),
                        ],
                        default="web_ui",
                        help_text="How this file was uploaded",
                        max_length=50,
                    ),
                ),
                (
                    "validation_errors",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="Summary of validation errors by type",
                    ),
                ),
                (
                    "data_quality_issues",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Summary of data quality issues found",
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="uploads",
                        to="upstream.customer",
                    ),
                ),
                (
                    "uploaded_by",
                    models.ForeignKey(
                        blank=True,
                        help_text="User who uploaded this file",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="uploads",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="DataQualityReport",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "total_rows",
                    models.IntegerField(default=0, help_text="Total rows in CSV file"),
                ),
                (
                    "accepted_rows",
                    models.IntegerField(
                        default=0, help_text="Rows that passed validation"
                    ),
                ),
                (
                    "rejected_rows",
                    models.IntegerField(
                        default=0, help_text="Rows that failed validation"
                    ),
                ),
                (
                    "rejection_details",
                    models.JSONField(
                        default=dict,
                        help_text="Map of row numbers to rejection reasons: {row_num: reason}",
                    ),
                ),
                (
                    "warnings",
                    models.JSONField(
                        default=list,
                        help_text="List of warning messages: [{row: int, message: str}]",
                    ),
                ),
                (
                    "phi_detections",
                    models.IntegerField(
                        default=0, help_text="Number of rows rejected for potential PHI"
                    ),
                ),
                (
                    "missing_fields",
                    models.IntegerField(
                        default=0,
                        help_text="Number of rows rejected for missing required fields",
                    ),
                ),
                (
                    "invalid_dates",
                    models.IntegerField(
                        default=0,
                        help_text="Number of rows rejected for invalid date formats",
                    ),
                ),
                (
                    "invalid_values",
                    models.IntegerField(
                        default=0,
                        help_text="Number of rows rejected for invalid field values",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="quality_reports",
                        to="upstream.customer",
                    ),
                ),
                (
                    "upload",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="quality_report",
                        to="upstream.upload",
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="DataAnomalyDetection",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "anomaly_type",
                    models.CharField(
                        choices=[
                            ("statistical_outlier", "Statistical Outlier"),
                            ("pattern_break", "Pattern Break"),
                            ("volume_anomaly", "Volume Anomaly"),
                            ("distribution_shift", "Distribution Shift"),
                            ("missing_data_spike", "Missing Data Spike"),
                            ("duplicate_spike", "Duplicate Spike"),
                        ],
                        db_index=True,
                        max_length=50,
                    ),
                ),
                ("field_name", models.CharField(blank=True, max_length=100)),
                (
                    "detected_at",
                    models.DateTimeField(
                        db_index=True, default=django.utils.timezone.now
                    ),
                ),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("low", "Low"),
                            ("medium", "Medium"),
                            ("high", "High"),
                            ("critical", "Critical"),
                        ],
                        db_index=True,
                        default="medium",
                        max_length=20,
                    ),
                ),
                (
                    "anomaly_score",
                    models.FloatField(
                        help_text="Anomaly score (higher = more anomalous)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "confidence",
                    models.FloatField(
                        help_text="Confidence in anomaly detection",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "description",
                    models.TextField(help_text="Human-readable anomaly description"),
                ),
                (
                    "statistical_details",
                    models.JSONField(
                        default=dict,
                        help_text="Statistical details: mean, std, z-score, etc.",
                    ),
                ),
                ("affected_row_count", models.IntegerField(default=0)),
                (
                    "recommended_action",
                    models.TextField(
                        blank=True, help_text="Recommended remediation action"
                    ),
                ),
                ("acknowledged", models.BooleanField(db_index=True, default=False)),
                ("acknowledged_at", models.DateTimeField(blank=True, null=True)),
                ("resolution_notes", models.TextField(blank=True)),
                (
                    "acknowledged_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="acknowledged_anomalies",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="data_anomalies",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "upload",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="anomalies",
                        to="upstream.upload",
                    ),
                ),
            ],
            options={
                "verbose_name": "Data Anomaly Detection",
                "verbose_name_plural": "Data Anomaly Detections",
                "ordering": ["-detected_at"],
            },
        ),
        migrations.CreateModel(
            name="ClaimValidationHistory",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("validation_passed", models.BooleanField(db_index=True, default=True)),
                ("error_count", models.IntegerField(default=0)),
                ("warning_count", models.IntegerField(default=0)),
                (
                    "quality_score",
                    models.FloatField(
                        blank=True,
                        help_text="Overall quality score for this claim",
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "validation_errors",
                    models.JSONField(
                        default=list,
                        help_text="List of validation errors: [{rule_code, message, field}]",
                    ),
                ),
                (
                    "validation_warnings",
                    models.JSONField(
                        default=list, help_text="List of validation warnings"
                    ),
                ),
                (
                    "validated_at",
                    models.DateTimeField(default=django.utils.timezone.now),
                ),
                (
                    "claim_record",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validations",
                        to="upstream.claimrecord",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="claim_validations",
                        to="upstream.customer",
                    ),
                ),
                (
                    "upload",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="claim_validations",
                        to="upstream.upload",
                    ),
                ),
            ],
            options={
                "verbose_name": "Claim Validation History",
                "verbose_name_plural": "Claim Validation Histories",
                "ordering": ["-validated_at"],
            },
        ),
        migrations.AddField(
            model_name="claimrecord",
            name="upload",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="claim_records",
                to="upstream.upload",
            ),
        ),
        migrations.CreateModel(
            name="UserProfile",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "role",
                    models.CharField(
                        choices=[
                            ("owner", "Owner"),
                            ("admin", "Admin"),
                            ("analyst", "Analyst"),
                            ("viewer", "Viewer"),
                        ],
                        default="viewer",
                        max_length=20,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="user_profiles",
                        to="upstream.customer",
                    ),
                ),
                (
                    "user",
                    models.OneToOneField(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="profile",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
        ),
        migrations.CreateModel(
            name="ValidationRule",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "name",
                    models.CharField(
                        help_text="Human-readable rule name", max_length=200
                    ),
                ),
                (
                    "code",
                    models.CharField(
                        help_text='Unique code for this rule (e.g., "REQ_001")',
                        max_length=50,
                    ),
                ),
                (
                    "rule_type",
                    models.CharField(
                        choices=[
                            ("required_field", "Required Field"),
                            ("format_check", "Format Check"),
                            ("range_check", "Range Check"),
                            ("date_logic", "Date Logic"),
                            ("phi_detection", "PHI Detection"),
                            ("reference_check", "Reference Data Check"),
                            ("business_rule", "Business Rule"),
                        ],
                        db_index=True,
                        max_length=30,
                    ),
                ),
                (
                    "field_name",
                    models.CharField(
                        blank=True,
                        help_text="Field this rule applies to (if field-specific)",
                        max_length=100,
                    ),
                ),
                (
                    "validation_logic",
                    models.JSONField(
                        default=dict,
                        help_text="Rule-specific validation configuration (regex, min/max, etc.)",
                    ),
                ),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("error", "Error - Reject Row"),
                            ("warning", "Warning - Accept with Flag"),
                            ("info", "Info - Log Only"),
                        ],
                        default="error",
                        max_length=20,
                    ),
                ),
                ("enabled", models.BooleanField(db_index=True, default=True)),
                (
                    "error_message_template",
                    models.TextField(
                        help_text="Error message template with {field} placeholders"
                    ),
                ),
                (
                    "remediation_guidance",
                    models.TextField(
                        blank=True, help_text="How to fix violations of this rule"
                    ),
                ),
                (
                    "applies_to_entity",
                    models.CharField(
                        default="claim_record",
                        help_text="Entity type this rule applies to (claim_record, upload, etc.)",
                        max_length=50,
                    ),
                ),
                (
                    "execution_order",
                    models.IntegerField(
                        default=100,
                        help_text="Order in which rules are executed (lower = earlier)",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validation_rules",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Validation Rule",
                "verbose_name_plural": "Validation Rules",
                "ordering": ["execution_order", "name"],
            },
        ),
        migrations.CreateModel(
            name="ValidationResult",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "row_number",
                    models.IntegerField(
                        blank=True,
                        help_text="Row number in CSV (if applicable)",
                        null=True,
                    ),
                ),
                ("field_name", models.CharField(blank=True, max_length=100)),
                (
                    "field_value",
                    models.TextField(
                        blank=True, help_text="The value that failed validation"
                    ),
                ),
                ("passed", models.BooleanField(db_index=True, default=False)),
                ("error_message", models.TextField()),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("error", "Error - Reject Row"),
                            ("warning", "Warning - Accept with Flag"),
                            ("info", "Info - Log Only"),
                        ],
                        db_index=True,
                        default="error",
                        max_length=20,
                    ),
                ),
                (
                    "context_data",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Additional context about the validation (full row data, etc.)",
                    ),
                ),
                (
                    "claim_record",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validation_results",
                        to="upstream.claimrecord",
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validation_results",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "upload",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validation_results",
                        to="upstream.upload",
                    ),
                ),
                (
                    "validation_rule",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="validation_results",
                        to="upstream.validationrule",
                    ),
                ),
            ],
            options={
                "verbose_name": "Validation Result",
                "verbose_name_plural": "Validation Results",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="WebhookEndpoint",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("name", models.CharField(max_length=100)),
                ("url", models.URLField()),
                (
                    "secret",
                    models.CharField(
                        blank=True, help_text="HMAC signing secret", max_length=64
                    ),
                ),
                ("active", models.BooleanField(default=True)),
                (
                    "event_types",
                    models.JSONField(
                        default=list, help_text="List of event types to send"
                    ),
                ),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="webhook_endpoints",
                        to="upstream.customer",
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Webhook Endpoint",
                "verbose_name_plural": "Webhook Endpoints",
            },
        ),
        migrations.CreateModel(
            name="WebhookDelivery",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                ("event_type", models.CharField(max_length=50)),
                ("payload", models.JSONField()),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending"),
                            ("success", "Success"),
                            ("failed", "Failed"),
                            ("retrying", "Retrying"),
                        ],
                        default="pending",
                        max_length=20,
                    ),
                ),
                ("attempts", models.IntegerField(default=0)),
                ("max_attempts", models.IntegerField(default=5)),
                ("last_attempt_at", models.DateTimeField(blank=True, null=True)),
                ("next_attempt_at", models.DateTimeField(blank=True, null=True)),
                ("last_error", models.TextField(blank=True, null=True)),
                ("response_code", models.IntegerField(blank=True, null=True)),
                ("response_body", models.TextField(blank=True, null=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_created",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "updated_by",
                    models.ForeignKey(
                        blank=True,
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="%(class)s_updated",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
                (
                    "endpoint",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="deliveries",
                        to="upstream.webhookendpoint",
                    ),
                ),
            ],
            options={
                "verbose_name": "Webhook Delivery",
                "verbose_name_plural": "Webhook Deliveries",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="CPTGroupMapping",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("cpt_code", models.CharField(max_length=10)),
                ("cpt_group", models.CharField(max_length=50)),
                (
                    "customer",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="cpt_group_mappings",
                        to="upstream.customer",
                    ),
                ),
            ],
            options={
                "unique_together": {("customer", "cpt_code")},
            },
        ),
        migrations.AddIndex(
            model_name="appealtemplate",
            index=models.Index(
                fields=["customer", "active", "-success_rate"],
                name="upstream_ap_custome_43ba55_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="appealtemplate",
            index=models.Index(
                fields=["customer", "denial_reason_code"],
                name="upstream_ap_custome_dadffb_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="appealtemplate",
            index=models.Index(
                fields=["customer", "payer"], name="upstream_ap_custome_47f128_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="appealgeneration",
            index=models.Index(
                fields=["customer", "status", "-generated_at"],
                name="upstream_ap_custome_642785_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="appealgeneration",
            index=models.Index(
                fields=["customer", "claim_record"],
                name="upstream_ap_custome_13e110_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="appealgeneration",
            index=models.Index(
                fields=["customer", "outcome"], name="upstream_ap_custome_0c84a7_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="dataqualitymetric",
            index=models.Index(
                fields=["customer", "metric_type", "-measurement_date"],
                name="upstream_da_custome_226bc6_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="dataqualitymetric",
            index=models.Index(
                fields=["customer", "measurement_date"],
                name="upstream_da_custome_6a1831_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="dataqualitymetric",
            index=models.Index(
                fields=["customer", "entity_type", "metric_type", "-measurement_date"],
                name="upstream_da_custome_24c4c9_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialaggregate",
            index=models.Index(
                fields=["customer", "aggregate_date"],
                name="upstream_de_custome_324147_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialaggregate",
            index=models.Index(
                fields=["customer", "payer", "aggregate_date"],
                name="upstream_de_custome_a5362f_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialaggregate",
            index=models.Index(
                fields=["customer", "payer", "denial_reason", "aggregate_date"],
                name="upstream_de_custome_da1c61_idx",
            ),
        ),
        migrations.AddConstraint(
            model_name="denialaggregate",
            constraint=models.UniqueConstraint(
                fields=(
                    "customer",
                    "payer",
                    "denial_reason",
                    "cpt_code",
                    "aggregate_date",
                ),
                name="unique_denial_aggregate",
            ),
        ),
        migrations.AddIndex(
            model_name="denialcascade",
            index=models.Index(
                fields=["customer", "resolved", "-created_at"],
                name="upstream_de_custome_59fa4e_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialcascade",
            index=models.Index(
                fields=["customer", "payer", "cascade_type"],
                name="upstream_de_custome_0609b3_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialcluster",
            index=models.Index(
                fields=["customer", "resolved", "-created_at"],
                name="upstream_de_custome_d5f021_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialcluster",
            index=models.Index(
                fields=["customer", "cluster_id"], name="upstream_de_custome_b4dbeb_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="denialcluster",
            unique_together={("customer", "cluster_id")},
        ),
        migrations.AddIndex(
            model_name="denialsignal",
            index=models.Index(
                fields=["customer", "-created_at"],
                name="upstream_de_custome_b3af87_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialsignal",
            index=models.Index(
                fields=["customer", "signal_type", "-created_at"],
                name="upstream_de_custome_d8959b_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="denialsignal",
            index=models.Index(
                fields=["customer", "severity", "-created_at"],
                name="upstream_de_custome_945a96_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="ingestionrecord",
            index=models.Index(
                fields=["customer", "status", "-created_at"],
                name="upstream_in_custome_d0f2fb_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="ingestionrecord",
            index=models.Index(
                fields=["customer", "source_type", "-created_at"],
                name="upstream_in_custome_bb2879_idx",
            ),
        ),
        migrations.AddConstraint(
            model_name="ingestionrecord",
            constraint=models.UniqueConstraint(
                condition=models.Q(("idempotency_key__isnull", False)),
                fields=("customer", "idempotency_key"),
                name="unique_customer_idempotency_key",
            ),
        ),
        migrations.AlterUniqueTogether(
            name="notificationchannel",
            unique_together={("customer", "name")},
        ),
        migrations.AlterUniqueTogether(
            name="alertrule",
            unique_together={("customer", "name")},
        ),
        migrations.AlterUniqueTogether(
            name="operatorjudgment",
            unique_together={("alert_event", "operator")},
        ),
        migrations.AlterUniqueTogether(
            name="payermapping",
            unique_together={("customer", "raw_name")},
        ),
        migrations.AddIndex(
            model_name="paymentdelayaggregate",
            index=models.Index(
                fields=["customer", "aggregate_date"],
                name="upstream_pa_custome_3353fc_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelayaggregate",
            index=models.Index(
                fields=["customer", "payer", "aggregate_date"],
                name="upstream_pa_custome_85c8a6_idx",
            ),
        ),
        migrations.AddConstraint(
            model_name="paymentdelayaggregate",
            constraint=models.UniqueConstraint(
                fields=("customer", "payer", "aggregate_date"),
                name="unique_payment_delay_aggregate",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelaysignal",
            index=models.Index(
                fields=["customer", "-created_at"],
                name="upstream_pa_custome_d43393_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelaysignal",
            index=models.Index(
                fields=["customer", "signal_type", "-created_at"],
                name="upstream_pa_custome_765983_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelaysignal",
            index=models.Index(
                fields=["customer", "severity", "-created_at"],
                name="upstream_pa_custome_551a1a_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelaysignal",
            index=models.Index(
                fields=["customer", "payer", "-created_at"],
                name="upstream_pa_custome_3f4a02_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelaysignal",
            index=models.Index(
                fields=["fingerprint"], name="upstream_pa_fingerp_136204_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelayevidenceartifact",
            index=models.Index(
                fields=["customer", "-generated_at"],
                name="upstream_pa_custome_dfec11_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelayevidenceartifact",
            index=models.Index(
                fields=["signal"], name="upstream_pa_signal__a15534_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelayclaimset",
            index=models.Index(
                fields=["customer", "-frozen_at"], name="upstream_pa_custome_8a6cc4_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paymentdelayclaimset",
            index=models.Index(
                fields=["fingerprint"], name="upstream_pa_fingerp_d4ce92_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="predenialwarning",
            index=models.Index(
                fields=["customer", "status", "-created_at"],
                name="upstream_pr_custome_ce1ec9_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="predenialwarning",
            index=models.Index(
                fields=["customer", "payer", "status"],
                name="upstream_pr_custome_f96c65_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="predenialwarning",
            index=models.Index(
                fields=["customer", "denial_probability"],
                name="upstream_pr_custome_2c108f_idx",
            ),
        ),
        migrations.AlterUniqueTogether(
            name="productconfig",
            unique_together={("customer", "product_slug")},
        ),
        migrations.AddConstraint(
            model_name="reportartifact",
            constraint=models.UniqueConstraint(
                fields=("customer", "report_run", "kind"),
                name="unique_artifact_per_customer_report_kind",
            ),
        ),
        migrations.AddIndex(
            model_name="driftevent",
            index=models.Index(
                fields=["customer", "-created_at"], name="drift_cust_created_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="driftevent",
            index=models.Index(
                fields=["customer", "payer", "drift_type"],
                name="drift_cust_payer_type_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="driftevent",
            index=models.Index(
                fields=["customer", "drift_type", "-created_at"],
                name="drift_cust_type_date_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="driftevent",
            index=models.Index(
                fields=["customer", "trend_direction", "-severity"],
                name="drift_trend_sev_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="driftevent",
            index=models.Index(
                fields=["customer", "suppressed", "-created_at"],
                name="drift_suppressed_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="alertevent",
            index=models.Index(
                fields=["customer", "status", "-triggered_at"],
                name="alertevt_cust_status_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="alertevent",
            index=models.Index(
                fields=["customer", "-notification_sent_at"],
                name="alertevt_cust_sent_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="alertevent",
            index=models.Index(
                fields=["alert_rule", "-triggered_at"], name="alertevt_rule_trig_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="systemevent",
            index=models.Index(
                fields=["customer", "event_type", "-created_at"],
                name="upstream_sy_custome_09ec75_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="systemevent",
            index=models.Index(
                fields=["customer", "-created_at"],
                name="upstream_sy_custome_fe0596_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="systemevent",
            index=models.Index(
                fields=["event_type", "-created_at"],
                name="upstream_sy_event_t_24c311_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="dataqualityreport",
            index=models.Index(
                fields=["customer", "-created_at"], name="dqr_cust_created_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="dataqualityreport",
            index=models.Index(fields=["upload"], name="dqr_upload_idx"),
        ),
        migrations.AddIndex(
            model_name="dataanomalydetection",
            index=models.Index(
                fields=["customer", "severity", "-detected_at"],
                name="upstream_da_custome_2354bc_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="dataanomalydetection",
            index=models.Index(
                fields=["customer", "anomaly_type", "-detected_at"],
                name="upstream_da_custome_84ccad_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="dataanomalydetection",
            index=models.Index(
                fields=["customer", "acknowledged", "-detected_at"],
                name="upstream_da_custome_f0308c_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimvalidationhistory",
            index=models.Index(
                fields=["customer", "upload", "validation_passed"],
                name="upstream_cl_custome_4ac5bb_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimvalidationhistory",
            index=models.Index(
                fields=["customer", "claim_record", "-validated_at"],
                name="upstream_cl_custome_9e7f13_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimvalidationhistory",
            index=models.Index(
                fields=["customer", "validation_passed", "-validated_at"],
                name="upstream_cl_custome_499276_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "submitted_date"], name="claim_cust_subdate_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "decided_date"], name="claim_cust_decdate_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "payer", "submitted_date"],
                name="claim_cust_payer_date_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "outcome", "decided_date"],
                name="claim_cust_outcome_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "authorization_required", "authorization_obtained"],
                name="claim_auth_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "validation_passed", "processed_at"],
                name="claim_validation_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="claimrecord",
            index=models.Index(
                fields=["customer", "payment_date"], name="claim_payment_date_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="validationrule",
            index=models.Index(
                fields=["customer", "enabled", "execution_order"],
                name="upstream_va_custome_25f01c_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="validationrule",
            index=models.Index(
                fields=["customer", "rule_type"], name="upstream_va_custome_16892a_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="validationrule",
            unique_together={("customer", "code")},
        ),
        migrations.AddIndex(
            model_name="validationresult",
            index=models.Index(
                fields=["customer", "upload", "severity"],
                name="upstream_va_custome_492346_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="validationresult",
            index=models.Index(
                fields=["customer", "validation_rule", "-created_at"],
                name="upstream_va_custome_afeb95_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="validationresult",
            index=models.Index(
                fields=["customer", "passed", "-created_at"],
                name="upstream_va_custome_a0c04a_idx",
            ),
        ),
        migrations.AlterUniqueTogether(
            name="webhookendpoint",
            unique_together={("customer", "name")},
        ),
    ]
